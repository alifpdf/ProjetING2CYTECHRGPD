<!DOCTYPE html>
<html lang="fr">
<head>
    <title>Intervalle par colonne</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            background: linear-gradient(to right, #74ebd5, #ACB6E5);
            min-height: 100vh;
        }
        .container {
            animation: fadeInUp 1s ease-out;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            padding: 30px;
            margin-top: 40px;
        }
        @keyframes fadeInUp {
            from {opacity:0; transform: translateY(20px);}
            to {opacity:1; transform: translateY(0);}
        }
        .form-check-label {
            cursor: pointer;
        }
        .form-control {
            transition: box-shadow 0.3s;
        }
        .form-control:focus {
            box-shadow: 0 0 10px #74ebd5;
        }
        .btn-success {
            background: linear-gradient(to right, #56ab2f, #a8e063);
            border: none;
        }
        .btn-success:hover {
            background: linear-gradient(to right, #a8e063, #56ab2f);
        }
    </style>
    <script>
        function toggleIntervalInput(colName) {
            const checkbox = document.getElementById('gen-' + colName);
            const intervalInput = document.getElementById('interval-' + colName);
            intervalInput.style.display = checkbox.checked ? 'block' : 'none';

            if (checkbox.checked) {
                intervalInput.setAttribute('required', 'required');
            } else {
                intervalInput.removeAttribute('required');
                intervalInput.value = '';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const checkboxes = document.querySelectorAll('.form-check-input');
            checkboxes.forEach((checkbox) => {
                checkbox.addEventListener('change', () => {
                    checkbox.parentElement.classList.toggle('bg-light', checkbox.checked);
                });
            });
        });
    </script>
</head>
<body>
<div class="container">
    <h2 class="text-center mb-4">GÃ©nÃ©ralisation & Masquage des colonnes</h2>
    <form method="POST" action="{{ url_for('process_csv') }}">
        <input type="hidden" name="filename" value="{{ filename }}">

        <div class="mb-4">
            <h5>ðŸ“Š Colonnes Ã  gÃ©nÃ©raliser avec intervalles :</h5>
            {% for col in columns %}
                <div class="form-check form-switch my-3">
                    <input class="form-check-input"
                           type="checkbox"
                           name="generalize_cols"
                           value="{{ col }}"
                           id="gen-{{ col }}"
                           onclick="toggleIntervalInput('{{ col }}')">
                    <label class="form-check-label" for="gen-{{ col }}">{{ col }}</label>
                    <input type="number"
                           step="any"
                           class="form-control mt-2"
                           name="interval_{{ col }}"
                           id="interval-{{ col }}"
                           placeholder="ðŸ”¢ Taille d'intervalle (ex: 10000)"
                           style="display:none;">
                </div>
            {% endfor %}
        </div>

        <div class="mb-4">
            <h5>ðŸš« Colonnes Ã  masquer :</h5>
            {% for col in columns %}
                <div class="form-check form-switch my-2">
                    <input class="form-check-input"
                           type="checkbox"
                           name="mask_cols"
                           value="{{ col }}"
                           id="mask-{{ col }}">
                    <label class="form-check-label" for="mask-{{ col }}">{{ col }}</label>
                </div>
            {% endfor %}
        </div>

        <button type="submit" class="btn btn-success w-100 py-2">âœ¨ Traiter le CSV âœ¨</button>
    </form>
</div>
</body>
</html>
