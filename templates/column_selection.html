<!DOCTYPE html> <!-- D√©clare que ce document est en HTML5 -->
<html lang="fr"> <!-- D√©marre la page HTML avec la langue fran√ßaise -->

<head> <!-- D√©but de l'en-t√™te HTML -->
    <title>Intervalle par colonne</title> <!-- Titre affich√© dans l‚Äôonglet du navigateur -->

    <!-- Import du CSS Bootstrap (framework de mise en forme responsive) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

    <!-- Import du JS Bootstrap (pour les composants interactifs : boutons, switchs, etc.) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <style> <!-- D√©but du style CSS personnalis√© -->
        body {
            background: linear-gradient(to right, #74ebd5, #ACB6E5); /* D√©grad√© bleu/rose en arri√®re-plan */
            min-height: 100vh; /* Hauteur minimale de la page = 100% de la fen√™tre */
        }

        .container {
            animation: fadeInUp 1s ease-out; /* Animation d‚Äôentr√©e */
            background-color: white; /* Fond blanc */
            border-radius: 10px; /* Coins arrondis */
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* Ombre port√©e */
            padding: 30px; /* Espacement int√©rieur */
            margin-top: 40px; /* Espacement au-dessus */
        }

        @keyframes fadeInUp { /* D√©finition de l‚Äôanimation fadeInUp */
            from {opacity:0; transform: translateY(20px);} /* D√©but : invisible + d√©cal√© vers le bas */
            to {opacity:1; transform: translateY(0);} /* Fin : visible et revenu √† sa place */
        }

        .form-check-label {
            cursor: pointer; /* Curseur devient une main sur le texte */
        }

        .form-control {
            transition: box-shadow 0.3s; /* Animation de focus douce */
        }

        .form-control:focus {
            box-shadow: 0 0 10px #74ebd5; /* Effet lumineux bleu lors de la saisie */
        }

        .btn-success {
            background: linear-gradient(to right, #56ab2f, #a8e063); /* D√©grad√© vert */
            border: none; /* Supprime la bordure par d√©faut */
        }

        .btn-success:hover {
            background: linear-gradient(to right, #a8e063, #56ab2f); /* Inverse le d√©grad√© au survol */
        }
    </style> <!-- Fin du style CSS -->

    <script> <!-- D√©but du script JS -->

        // Fonction qui affiche/masque le champ d‚Äôintervalle quand on coche la case
        function toggleIntervalInput(colName) {
            const checkbox = document.getElementById('gen-' + colName); // Checkbox concern√©e
            const intervalInput = document.getElementById('interval-' + colName); // Champ associ√©

            // Affiche ou masque le champ d'intervalle selon l'√©tat de la case
            intervalInput.style.display = checkbox.checked ? 'block' : 'none';

            // Rend le champ obligatoire si la case est coch√©e
            if (checkbox.checked) {
                intervalInput.setAttribute('required', 'required');
            } else {
                intervalInput.removeAttribute('required'); // Plus requis
                intervalInput.value = ''; // R√©initialisation
            }
        }

        // Ajoute un effet visuel (fond clair) aux cases coch√©es
        document.addEventListener('DOMContentLoaded', () => {
            const checkboxes = document.querySelectorAll('.form-check-input'); // Toutes les cases
            checkboxes.forEach((checkbox) => {
                checkbox.addEventListener('change', () => {
                    checkbox.parentElement.classList.toggle('bg-light', checkbox.checked); // Ajoute ou retire un fond clair
                });
            });
        });
    </script> <!-- Fin du script JS -->
</head> <!-- Fin de l‚Äôen-t√™te -->

<body> <!-- D√©but du corps HTML -->

<!-- Conteneur principal de la page -->
<div class="container">
    <h2 class="text-center mb-4">G√©n√©ralisation & Masquage des colonnes</h2> <!-- Titre de la section -->

    <!-- Formulaire qui envoie les donn√©es vers la route Flask process_csv -->
    <form method="POST" action="{{ url_for('process_csv') }}">
        <!-- Champ cach√© qui contient le nom du fichier √† traiter -->
        <input type="hidden" name="filename" value="{{ filename }}">

        <!-- Bloc pour la g√©n√©ralisation des colonnes -->
        <div class="mb-4">
            <h5>üìä Colonnes √† g√©n√©raliser avec intervalles :</h5>

            <!-- Boucle Jinja sur chaque colonne pour afficher une option de g√©n√©ralisation -->
            {% for col in columns %}
                <div class="form-check form-switch my-3">
                    <!-- Checkbox pour activer la g√©n√©ralisation d‚Äôune colonne -->
                    <input class="form-check-input"
                           type="checkbox"
                           name="generalize_cols"
                           value="{{ col }}"
                           id="gen-{{ col }}"
                           onclick="toggleIntervalInput('{{ col }}')"> <!-- Active l'affichage du champ d'intervalle -->

                    <!-- Label affichant le nom de la colonne -->
                    <label class="form-check-label" for="gen-{{ col }}">{{ col }}</label>

                    <!-- Champ d‚Äôentr√©e pour d√©finir l‚Äôintervalle, masqu√© par d√©faut -->
                    <input type="number"
                           step="any"
                           class="form-control mt-2"
                           name="interval_{{ col }}"
                           id="interval-{{ col }}"
                           placeholder="üî¢ Taille d'intervalle (ex: 10000)"
                           style="display:none;">
                </div>
            {% endfor %}
        </div>

        <!-- Bloc pour le masquage des colonnes -->
        <div class="mb-4">
            <h5>üö´ Colonnes √† masquer :</h5>

            <!-- Boucle Jinja pour chaque colonne √† masquer -->
            {% for col in columns %}
                <div class="form-check form-switch my-2">
                    <!-- Checkbox de masquage -->
                    <input class="form-check-input"
                           type="checkbox"
                           name="mask_cols"
                           value="{{ col }}"
                           id="mask-{{ col }}">
                    <label class="form-check-label" for="mask-{{ col }}">{{ col }}</label>
                </div>
            {% endfor %}
        </div>

        <!-- Bouton de soumission du formulaire -->
        <button type="submit" class="btn btn-success w-100 py-2">‚ú® Traiter le CSV ‚ú®</button>
    </form>
</div> <!-- Fin du conteneur -->
</body> <!-- Fin du body -->
</html> <!-- Fin du document HTML -->
